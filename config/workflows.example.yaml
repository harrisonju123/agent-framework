# Example workflow configurations
# Copy this file to workflows.yaml and customize for your needs

workflows:
  # Simple workflow: architect plans, engineer implements, no QA needed
  simple:
    description: "Quick workflow for bug fixes and small changes"
    agents:
      - architect
      - engineer
    pr_creator: engineer
    auto_review: false
    require_tests: true

  # Standard workflow: includes QA verification
  standard:
    description: "Standard workflow with QA verification"
    agents:
      - architect
      - engineer
      - qa
    pr_creator: qa
    auto_review: true
    require_tests: true

  # Production deployment workflow with code review
  production-deploy:
    description: "Production deployment workflow with full code review"
    steps:
      architect:
        agent: architect
        next:
          - target: engineer

      engineer:
        agent: engineer
        next:
          - target: code_review

      code_review:
        agent: architect
        next:
          - target: qa
            condition: approved
            priority: 10
          - target: engineer
            condition: needs_fix
            priority: 5

      qa:
        agent: qa
        next: []
    start_step: architect
    pr_creator: qa
    auto_review: true
    require_tests: true

  # Database migration workflow
  schema-migration:
    description: "Database schema migration with QA verification"
    steps:
      architect:
        agent: architect
        next:
          - target: engineer

      engineer:
        agent: engineer
        next:
          - target: qa

      qa:
        agent: qa
        next: []
    start_step: architect
    pr_creator: qa
    auto_review: true
    require_tests: true

  # Conditional workflow with size-based routing
  smart-deploy:
    description: "Smart deployment with conditional routing based on change size"
    steps:
      architect:
        agent: architect
        next:
          - target: engineer

      engineer:
        agent: engineer
        next:
          # Small changes (<5 files) go directly to QA
          - target: qa
            condition: pr_size_under
            params:
              max_files: 5
            priority: 10

          # Large changes go through code review first
          - target: code_review
            condition: always
            priority: 0

      code_review:
        agent: architect
        next:
          - target: qa

      qa:
        agent: qa
        next: []
    start_step: architect
    pr_creator: qa
    auto_review: true
    require_tests: true

  # Preview workflow: architect plans, engineer does read-only preview, architect reviews
  # and authorizes, then engineer implements. Use for high-risk or unfamiliar changes.
  preview:
    description: "Preview workflow with architect review gate before implementation"
    steps:
      architect:
        agent: architect
        next:
          - target: preview

      preview:
        agent: engineer
        task_type_override: preview
        next:
          - target: review

      review:
        agent: architect
        next:
          # Architect approved preview â€” engineer proceeds with implementation
          - target: implement
            condition: preview_approved
            priority: 10
          # Architect wants changes to the plan before implementation
          - target: preview
            condition: needs_fix
            priority: 5

      implement:
        agent: engineer
        next: []
    start_step: architect
    pr_creator: engineer
    auto_review: false
    require_tests: true

# Workflow selection guide:
#
# Use 'simple' for:
#   - Bug fixes
#   - Documentation updates
#   - Small refactors
#
# Use 'standard' for:
#   - New features
#   - API changes
#   - UI updates
#
# Use 'production-deploy' for:
#   - Production deployments
#   - Live system changes
#   - Customer-facing updates
#
# Use 'schema-migration' for:
#   - Database changes
#   - Schema updates
#   - Data migrations
#
# Use 'smart-deploy' for:
#   - Mixed workloads
#   - Automatic risk assessment
#   - Size-based routing
